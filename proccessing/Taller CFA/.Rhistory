knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(lavaan, # pacman para instalar / cargar
psych, # para funcion lowerMat
Hmisc, # rcorr
stargazer,
xtable,
semPlot,
semTools,
remedy
)
trust= chile%>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(lavaan, # pacman para instalar / cargar
psych, # para funcion lowerMat
Hmisc, # rcorr
stargazer,
xtable,
semPlot,
semTools,
remedy
)
rm(list = ls()) #limpiar la memoria
#Desactivar notaci?n cient?fica
options(scipen=999)
pacman::p_load(dplyr, texreg, xtable, stargazer, # Reporte a latex
sjPlot, sjmisc, # reporte y gráficos
skimr,
corrplot, # grafico correlaciones
xtable, # Reporte a latex
Hmisc, # varias funciones
psych, # fa y principal factors
psy, # scree plot function
nFactors, # parallel
GPArotation, devtools, CTT, lavaan, semTable, GGally, QuantPsyc)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#Authoritarianism
mutate(dicta1         = 5-LS3G01A) %>% #Government leaders to make decisions without consulting anybody
mutate(dicta2         = 5-LS3G01B) %>% #People in government must enforce their authority even
mutate(dicta3         = 5-LS3G01C) %>% #People in government lose part of their authority
mutate(dicta4         = 5-LS3G01D) %>% #People whose opinions are different must be considered its enemies
mutate(dicta5         = 5-LS3G01E) %>% #The most important opinion of a country should be that of the pres
mutate(dicta6         = 5-LS3G01F) %>% #It is fair that the government does not comply with the law
mutate(dicta7         = 5-LS3G02A) %>% #It is fair that the government does not comply with the law
mutate(dicta8         = 5-LS3G02B) %>% #Concentration of power in one person guarantees order
mutate(dicta9         = 5-LS3G02C) %>% #If the president does not agree withCongress>, he should dissolve
mutate(dicta_safety    = 5-LS3G02D) %>% #DICTATORSHIPS ARE JUSTIFIED WHEN THEY BRING ORDER AND SAFETY
mutate(dicta_benefits  = 5-LS3G02E) %>% #DICTATORSHIPS ARE JUSTIFIED WHEN THEY BRING ECONOMIC BENEFITS
#Dummies
mutate(dicta1_d      = recode(dicta1, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta2_d      = recode(dicta2, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta3_d      = recode(dicta3, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta4_d      = recode(dicta4, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta5_d      = recode(dicta5, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta6_d      = recode(dicta6, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta7_d      = recode(dicta7, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta8_d      = recode(dicta8, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta9_d      = recode(dicta9, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta_saf_d  = recode(dicta_safety, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(dicta_ben_d  = recode(dicta_benefits, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#Civic Knowledge
mutate(pv1civ          = PV1CIV) %>%
mutate(pv2civ          = PV2CIV) %>%
mutate(pv3civ          = PV3CIV) %>%
mutate(pv4civ          = PV4CIV) %>%
mutate(pv5civ          = PV5CIV) %>%
mutate(civic_knowledge = (pv1civ + pv2civ + pv3civ + pv4civ + pv5civ)/5) %>% #MEAN CIVIC KNOWLEDGE
#Variables creadas
mutate(s_opdisc        = S_OPDISC) %>%  #OPENNESS IN CLASS DISCUSSION
mutate(s_hisced        = S_HISCED) %>%  #HIGHEST PARENTAL EDUCATIONAL LEVEL
mutate(univ            = ifelse(s_hisced>3, 1, 0)) %>% #UNIVERSITY
mutate(s_hisei         = S_HISEI) %>%   #PARENT'S HIGHEST OCCUPATIONAL STATUS
mutate(s_homelit       = S_HOMLIT) %>%  #HOME LITERACY
mutate(s_gender        = S_GENDER) %>%  #GENDER OF STUDENT
mutate(s_age           = S_AGE) %>%     #AGE STUDENT
mutate(s_citcon        = S_CITCON) %>%  #CONVENTIONAL CITIZENSHIP
mutate(s_citsoc        = S_CITSOC) %>%  #SOCIAL MOVEMENT REL. CITIZENSHIP
mutate(s_citeff        = S_CITEFF) %>%  #CITIZENSHIP SELF-EFFICACY
mutate(s_cntatt        = S_CNTATT) %>%  #ATTITUDES TOWARDS OWN COUNTRY
mutate(s_geneql        = S_GENEQL) %>%  #ATTITUDES TOWARDS GENDER EQUALITY
mutate(s_ethrght       = S_ETHRGHT) %>% #EQUAL RIGHTS FOR ALL ETHNIC GROUPS
mutate(l_attviol       = L_ATTVIOL) %>% #ATTITUDES: USE OF VIOLENCE
mutate(l_attdiv        = L_ATTDIV) %>%  #ATTITUDES: NEIGHBOURHOOD DIVERSITY
mutate(l_autgov        = L_AUTGOV) %>%  #AUTHORITARIANISM IN GOVERNMENT
mutate(l_attcorr       = L_ATTCORR) %>% #CORRUPT PRACTICES IN GOVERNMENT
mutate(l_dislaw        = L_DISLAW) %>%  #ATTITUDES: DISOBEYING THE LAW
mutate(l_empclas       = L_EMPCLAS) %>% #EMPATHY TOWARDS CLASSMATES
mutate(s_poldisc       = S_POLDISC) %>% #DISCUSSION OF POL. AND SOC. ISSUES
#SES
mutate(educacion=s_hisced) %>%
mutate(libros=s_homelit) %>%
mutate(nina=s_gender) %>%
mutate(civico=pv1civ)%>%
mutate(discusion=s_poldisc)%>%
mutate(apdiscusion=s_opdisc)%>%
#WEIGHTS
mutate(totwgts         = TOTWGTS) %>%   #FINAL STUDENT WEIGHT
mutate(wgtfac1         = WGTFAC1) %>%   #SCHOOL BASE WEIGHT
mutate(wgtadj1s        = WGTADJ1S) %>%  #SCHOOL WEIGHT ADJUSTMENT-STUDENT STUDY
mutate(wgtfac2s        = WGTFAC2S) %>%  #CLASS WEIGHT FACTOR
mutate(wgtadj2s        = WGTADJ2S) %>%  #CLASS WEIGHT ADJUSTMENT
mutate(wgtadj3s        = WGTADJ3S) %>%  #STUDENT WEIGHT ADJUSTMENT
mutate(jkzones         = JKZONES)  %>%  #JACKKNIFE ZONE - STUDENT STUDY
mutate(jkreps          = JKREPS)  %>%  #JACKKNIFE REPLICATE CODE
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa, educacion, libros, discusion, apdiscusion, nina, pv1civ)
skim(chile)
#chile= chile%>%
#  na.omit()
trust= chile%>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa)
#summary(trust)
stargazer(trust,title="Estadísticos descriptivos", type = "text")
corMat  <- cor(trust, use="na.or.complete")  # estimar matriz pearson
options(digits=3) # decimales
print(corMat)
stargazer(corMat, title="correlaciones", type = "text") #Latex table
M=cor(trust, use="na.or.complete")
corrplot(M, type="lower",
order="AOE", cl.pos="b", tl.pos="d") #agrega nombres en diag.
sjp.corr(trust, na.deletion = c("listwise"))
KMO(corMat)
cortest.bartlett(corMat, n = 5081)
shapiro.test(trust$nac_gob)
fac <- fa(r = trust, fm= "ml", nfactors=2, rotate="promax")
fac
factor.plot(fac, labels=rownames(fac$loadings))
scree.plot(trust)
#fa.parallel(corMat, n.obs=5081)
fac <- fa(r = trust, fm= "ml", nfactors=2, rotate="varimax")
fac
fac <- fa(r = trust, fm= "ml", nfactors=2, rotate="promax")
fac
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#Civic Knowledge
mutate(pv1civ          = PV1CIV) %>%
mutate(pv2civ          = PV2CIV) %>%
mutate(pv3civ          = PV3CIV) %>%
mutate(pv4civ          = PV4CIV) %>%
mutate(pv5civ          = PV5CIV) %>%
mutate(civic_knowledge = (pv1civ + pv2civ + pv3civ + pv4civ + pv5civ)/5) %>% #MEAN CIVIC KNOWLEDGE
#SES
mutate(educacion=s_hisced) %>%
mutate(libros=s_homelit) %>%
mutate(nina=s_gender) %>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa, educacion, libros, discusion, apdiscusion, nina, pv1civ)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#Civic Knowledge
mutate(pv1civ          = PV1CIV) %>%
mutate(pv2civ          = PV2CIV) %>%
mutate(pv3civ          = PV3CIV) %>%
mutate(pv4civ          = PV4CIV) %>%
mutate(pv5civ          = PV5CIV) %>%
mutate(civic_knowledge = (pv1civ + pv2civ + pv3civ + pv4civ + pv5civ)/5) %>% #MEAN CIVIC KNOWLEDGE
#SES
mutate(libros=s_homelit) %>%
mutate(nina=s_gender) %>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa, libros, discusion, apdiscusion, nina, pv1civ)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#Civic Knowledge
mutate(pv1civ          = PV1CIV) %>%
mutate(pv2civ          = PV2CIV) %>%
mutate(pv3civ          = PV3CIV) %>%
mutate(pv4civ          = PV4CIV) %>%
mutate(pv5civ          = PV5CIV) %>%
mutate(civic_knowledge = (pv1civ + pv2civ + pv3civ + pv4civ + pv5civ)/5) %>% #MEAN CIVIC KNOWLEDGE
#SES
mutate(libros=s_homelit) %>%
mutate(nina=s_gender) %>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa, discusion, apdiscusion, pv1civ)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
#Civic Knowledge
mutate(pv1civ          = PV1CIV) %>%
mutate(pv2civ          = PV2CIV) %>%
mutate(pv3civ          = PV3CIV) %>%
mutate(pv4civ          = PV4CIV) %>%
mutate(pv5civ          = PV5CIV) %>%
mutate(civic_knowledge = (pv1civ + pv2civ + pv3civ + pv4civ + pv5civ)/5) %>% #MEAN CIVIC KNOWLEDGE
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa, discusion, apdiscusion, pv1civ)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa,school,unit_nations,people,social)
skim(chile)
#chile= chile%>%
#  na.omit()
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(lavaan, # pacman para instalar / cargar
psych, # para funcion lowerMat
Hmisc, # rcorr
stargazer,
xtable,
semPlot,
semTools,
remedy
)
rm(list = ls()) #limpiar la memoria
#Desactivar notaci?n cient?fica
options(scipen=999)
pacman::p_load(dplyr, texreg, xtable, stargazer, # Reporte a latex
sjPlot, sjmisc, # reporte y gráficos
skimr,
corrplot, # grafico correlaciones
xtable, # Reporte a latex
Hmisc, # varias funciones
psych, # fa y principal factors
psy, # scree plot function
nFactors, # parallel
GPArotation, devtools, CTT, lavaan, semTable, GGally, QuantPsyc)
load("../input/data/ICCS16.Rdata")
#skim(iccs16)
#names(iccs16)
chile = iccs16 %>%
filter(COUNTRY== "CHL")%>%
mutate(country         = COUNTRY) %>%
mutate(idcountry       = IDCNTRY) %>%
mutate(idschool        = IDSCHOOL) %>%
mutate(idstudent       = IDSTUD) %>%
#TRUST
mutate(s_intrust       = S_INTRUST) %>% #TRUST IN CIVIC INSTITUTIONS
mutate(nac_gob         = 5 - IS3G26A) %>%   #TRUST INSTITUTIONS-NATIONAL GOVERNMENT
mutate(local_gob       = 5 - IS3G26B) %>%   #TRUST INSTITUTIONS-LOCAL GOVERNMENT
mutate(courts          = 5 - IS3G26C) %>%   #TRUST INSTITUTIONS-COURTS
mutate(police          = 5 - IS3G26D) %>%   #TRUST INSTITUTIONS-POLICE
mutate(pol_parties     = 5 - IS3G26E) %>%   #TRUST INSTITUTIONS-POLITICAL PARTIES
mutate(parliament      = 5 - IS3G26F) %>%   #TRUST INSTITUTIONS-PARLIAMENT
mutate(media           = 5 - IS3G26G) %>%   #TRUST INSTITUTIONS-MEDIA
mutate(ffaa            = 5 - IS3G26I) %>%   #TRUST INSTITUTIONS-FFAA
mutate(school          = 5 - IS3G26J) %>%   #TRUST INSTITUTIONS-SCHOOL
mutate(unit_nations    = 5 - IS3G26K) %>%   #TRUST INSTITUTIONS-UNITED NATIONS
mutate(people          = 5 - IS3G26L) %>%   #TRUST INSTITUTIONS-PEOPLE
mutate(social          = 5 - IS3G26H) %>%   #TRUST INSTITUTIONS-SOCIAL MEDIA
#Dummies
mutate(nac_gob_d         = recode(nac_gob,     "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(local_gob_d       = recode(local_gob,   "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(courts_d          = recode(courts,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(police_d          = recode(police,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(pol_parties_d     = recode(pol_parties, "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(parliament_d      = recode(parliament,  "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(media_d           = recode(media,       "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(ffaa_d            = recode(ffaa,        "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(school_d          = recode(school,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(unit_nations_d    = recode(unit_nations,"1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(people_d          = recode(people,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
mutate(social_d          = recode(social,      "1"=0, "2"=0, "3"=1, "4"=1)) %>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa,school,unit_nations,people,social)
skim(chile)
#chile= chile%>%
#  na.omit()
trust= chile%>%
dplyr::select(nac_gob, local_gob, courts, police, pol_parties, parliament, media, ffaa,school,unit_nations,people,social)
#summary(trust)
stargazer(trust,title="Estadísticos descriptivos", type = "text")
corMat  <- cor(trust, use="na.or.complete")  # estimar matriz pearson
options(digits=3) # decimales
print(corMat)
stargazer(corMat, title="correlaciones", type = "text") #Latex table
M=cor(trust, use="na.or.complete")
corrplot(M, type="lower",
order="AOE", cl.pos="b", tl.pos="d") #agrega nombres en diag.
sjp.corr(trust, na.deletion = c("listwise"))
KMO(corMat)
cortest.bartlett(corMat, n = 5081)
fac <- fa(r = trust, fm= "ml", nfactors=2, rotate="promax")
fac
factor.plot(fac, labels=rownames(fac$loadings))
scree.plot(trust)
#fa.parallel(corMat, n.obs=5081)
fac2 <- fa(r = trust, fm= "ml", nfactors=3, rotate="promax")
fac2
factor.plot(fac2, labels=rownames(fac$loadings))
#fa.parallel(corMat, n.obs=5081)
fac2 <- fa(r = trust, fm= "ml", nfactors=3, rotate="varimax")
fac2
factor.plot(fac2, labels=rownames(fac$loadings))
fac2
fac <- fa(r = trust, fm= "ml", nfactors=2, rotate="promax")
fac
factor.plot(fac, labels=rownames(fac$loadings))
scree.plot(trust)
#fa.parallel(corMat, n.obs=5081)
fac2 <- fa(r = trust, fm= "ml", nfactors=3, rotate="promax")
fac2
factor.plot(fac2, labels=rownames(fac$loadings))
#fa.parallel(corMat, n.obs=5081)
print(fac2)
trust
fa.diagrama(fa.ninguno)
fa.diagrama(fac2)
fa.diagram(fac2)
fac2 <- fa(r = trust, fm= "ml", nfactors=3, rotate="promax")
fac2
print(fac2)
factor.plot(fac2, labels=rownames(fac$loadings))
#fa.parallel(corMat, n.obs=5081)
fac2 <- fa(r = trust, fm= "ml", nfactors=3, rotate="promax")
fac2
factor.plot(fac2, labels=rownames(fac2$loadings))
#fa.parallel(corMat, n.obs=5081)
